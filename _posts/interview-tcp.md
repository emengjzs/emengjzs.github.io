## TCP

### 超时与重传

可靠传输：设定一个超时时间，超过后被认为数据没有传送到对方，重新再将数据发送。

重传定时器：使用指数退避函数设置每次超时时间，重要参数是往返测量时间RTT，RTT（Round Trip Time）由三部分组成：链路的传播时间（propagation delay）、末端系统的处理时间、
路由器缓存中的排队和处理时间（queuing delay），由于路由器缓存中的排队和处理时间会随着整个网络拥塞程度的变化而变化，故RTT估算值需要根据实时情况进行调整。

RTT采样测量方法：（1）TCP Timestamp选项，带有发送时的时间戳，RTT = 当前时间 -  数据包中Timestamp选项的回显时间。（2）重传队列中数据包的TCP控制块（数据结构，包含发送时间），但在发生重传时不能确定对方返回的确认是否是重传返回的还是第一次返回的，所以对重传的报文不计算RTT

RTO计算：由RTT估计值、RTT平均偏差值得出



## 连接建立







## 2MSL

1. 保证TCP协议的全双工连接能够可靠关闭，最后的ack有可能没有成功发送，当在MSL期间收到ack时，说明丢包，主动关闭方再次发送ack
2. 保证这次连接的重复数据段从网络中消失，丢弃期间收到的数据，防止在下次复用连接时之前的滞留的数据被误认。





